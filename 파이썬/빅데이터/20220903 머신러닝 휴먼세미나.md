기초적인것들은 정리에서 좀 뺐음.

<개요>
강사 : 오승환 대표
일시 : 20220903
전공 : 서울대 건축학과 학사, 방통대 컴퓨터과학 학사
경력 : 전 DACON 부대표. 전 인덕대 컴퓨터소프트웨어학과 겸임교수, 현 다파다 대표이사
      (현재 팀원수는 적고 대학생들)
저서 : 파이썬 머신러닝 판다스 데이터분석, 실무자를 위한 파이썬 100제, 파이썬 딥러닝 머신러닝 입문, 파이썬 딥러닝 텐서플로

<사전 질의>
1. 전체적인 프로젝트를 설계, 수행하는 능력  //주제선정, 데이터수집, 전처리, 라이브러리, 결과분석, 시각화
//가중치와 옵티마이저 함수를 파라미터로 전달해준다.
2. 머신러닝 엔진의 수학적 알고리즘(옵티마이저. 최적화함수)
  - 등산의 하산으로 옵티마이저 이해.
  Adam을 가장 많이 사용.
  경사하강법, Momentum등도 옵티마이저들임.
3. 실제 현장 적용사례들
4. 강의가 짧고 순서대로 정리된 잘작동된 블로그나 사이트 추천
5. 머신러닝 스프링에 서빙 및 배포(MLOps)

<1교시>
1. 강사 소개
2. 데이터과학 = 수학, 머신러닝, 통계학, 시각화, 정보공학, 빅데이터, 패턴인식
3. 대부분의 시간을 분석보다는 수집,정제에 사용
   //아무리 좋은 모델을 사용하더라도 학습시킨 데이터가 목적에 맞지 않는다면 예측이 엉망이됨
   //예를들어 뉴스, 컬럼 등으로 학습해봤자 SNS같은 신조어많은 곳에서는 바보됨
4. 데이터분석의 목적 : 현상과 원인의 패턴을 파악하여 미래를 예측하는 모델을 만드는 것
5. 코로나 이후로 세계가 바뀌었기 때문에 과거의 데이터가 많다고해서 모델 잘 만들수 있는것 아니고, 오히려 잘 안만들어질 수도 있다.
6. 데이터분석 프로세스
   1. 문제정의
      1. 비지니스의 목적 명확하게. ML모델의 용도 및 필요성
      2. 기존 솔루션 사례조사와 개선방향 도출
      3. 어떤 ML학습유형쓸지 검토
      4. 성능 목표 설정
      5. 목표 미달시 대응방안
      6. 다양한 가설 수립
      7. 리소스 준비
   2. 데이터수집
      1. ML학습유형에 맞는 데이터의 종류와 필요한 수량을 검토
         //지도학습의 경우 라벨링 데이터와, 라벨링 방안
      2. 데이터수집이 가능한 곳을 탐색
      3. 데이터수집에 필요한 권한, 저작권, 라이센스 등 확인
      4. 데이터수집을 위한 시스템 구성
      5. 데이터 처리 방식(전처리, 파일형태, 폴더구성, 테스트셋 구성 등)
      6. 민감 정보 확인후 제거
      7. 데이터 수집 및 ML 데이터셋 구성(Train / Test)

   3. 데이터 탐색 및 전처리
      1. 놓침
      2. 놓침
      3. 알고리즘 선정
         1. 선형관계가 두드러지면 선형회귀모델
            간단한 문제는 가벼운 모델, 어려운 문제는 복잡한 모델
         2. 최대한 많은 알고리즘을 빠르게 학습하고 성능 비교
         //딥러닝을 쓰게되면 이런거 신경안써도된다. 데이터만 많이 주면 알아서 해준다.
         //대신, why를 알아낼수없다.
      4. 모델 튜닝
         1. 개별모델을 하이퍼 파라미터 튜닝으로 성능개선
         //단순작업이고 많은 시간 든다. 매개변수 수정하면서 재학습
         2. Hold-Out 교차검증
         3. K-Fold 교차검증  //최종으로 한번더 검증하는 방법. 학습데이터를 k개로 균등분할하여 1개만 검증용, k-1개는 훈련용으로 사용하는걸 k번 돌림. 일반적으로 5,10을 사용
         그럼 모델이 총 k개가 나옴
   4. 모델링
      1. 데이터 수집 및 전처리
      2. 데이터 분리(학습용으로 훈련용, 검증용,  별도의 테스트용)
         //유의해서 분리해야한다.  테스트데이터는 1회용. 한번쓰고 안맞으면 모델과 테스트 데이터 폐기해야됨. 간접학습이 되기 때문
      3. 알고리즘 선택
      4. 모델 학습
      5. 예측
      6. 모델성능평가   //성능이 안나오면 전단계 반복
         //언제까지 반복하나요?? 처음에 목적한 목표치에 도달할만큼
      7. 모델적용
      //수학적 이해하려고 하면 학습속도 매우 느리다. 오히려 창의성,실험정신 중요
   5. 활용
7. 머신러닝 = 사람의 역할이였던 규칙과 패턴을 파악하는것을 기계가 하는 인공지능
   pycaret.org      //머신러닝 알고리즘 적용 한 3줄이면 된다.
   fastai.ai        //딥러닝쪽
   huggingface.co   //자연어처리
   github.com/Beomi/KcELECTRA       //공개된 한국어모델. 
   github.com/openai/gym    //강화학습

<2교시>
- 머신러닝 학습 분류
  - 정답라벨 유무
    - 지도, 비지도, 준지도
  - 실시간 학습 여부
    - 온라인, 배치
  - 기존데이터와 비교하는지
    - 사례기반, 모델

- **머신러닝 유형과 학습 알고리즘**
https://scikit-learn.org/stable/
일부 회귀 알고리즘은 분류에 사용할 수 있고 또 반대의 경우도 있다.
예를들어 로지스틱 회귀는 알고리즘은 회귀지만 분류모델에 사용된다. 
스팸메일일 확률 20%. 이런식으로.
선형회귀로도 분류를 할수는 있지만 권장하지 않는다. 예를들어 100시간넘게 공부하면 통과, 99시간 59분 공부하면 불합격으로 판단하기 때문에.

  - ## **지도학습**(supervised learning)
      - #### **분류**(classification)
      > 몇개의 정해진 분류중 어디에속할지 예측. 스팸메일인지, 현역인지공익인지, 와인의 등급
      - 로지스틱회귀(Logistic Regression)
        : 선형회귀에 sigmoid를 돌려 0~1의 값을 반환받아 이진분류

      - #### **회귀**(regression)
      > 연속적인 값 예측. 독립변수와 종속변수간의 상관관계를 모델링하는것이 기본개념. 
      > 독립변수에 영향을 미치는 회귀계수의 최적값을 찾아 종속변수값을 예측해내는 것.
      - 직선만 선형이라고 잘못알아듣게 설명된곳이 많은데 로그함수나 다차방정식도 선형이다. 단순직선이 아닐뿐이지.
      - 선형(Linear)이나 비선형(Non-Linear)이냐를 구분하는것은 '변수'가 아니라 '**회귀 계수**'다.
      - 선형 회귀모델은 다시 종속변수의 갯수에따라 단변량 (Univariate), 다변량 (Multivariate)로 나뉜다.
      - 독립변수X의 갯수에 따라 단순(Simple), 다중(Multiple)로 나뉜다.
      다중회귀는 항이 추가될수록 과적합이 일어날 가능성이 커지므로 3차이상은 잘 넣지 않는다.

         - ###### 결정트리(Decision Tree)
         - ###### 랜덤포레스트(Random Forests)
         - ###### k최근접이웃(KNN : k-Nearest Neighbors)
           : 나와가장 가까운이웃 k개를 보고 가장 많은유형을 결과로 반환
         - ###### 서포트벡터머신(SVM : Support Vector Machines)
         - ###### 신경망(Neural Network)
      
      (유의)
      고전적 선형 회귀모델은 형태가 단순한만큼 데이터에 대해 많은 가정을 갖고있다.
      실제 데이터가 아래와 같은 가정을 충족하지 않는다면 고전적 선형 회귀모델로는 실제 데이터를 정확히 반영하지 못하게 되므로 다른 방법을 사용해야 한다.
      - 오차항은 평균이 0이고 분산이 일정한 정규 분포를 갖는다.
      - 독립변수와 종속변수는 선형 관계이다.
      - 오차항은 자기 상관성이 없다.
      - 데이터에 아웃라이어가 없다.
      - 독립변수와 오차항은 서로 독립이다.
      - 독립변수 간에서는 서로 선형적으로 독립이다.

      //Linear regression 알고리즘 : 주어진 데이터를 가장 잘 표현하는 직선을 찾아내는 일을 함
      
      //Cost function, Loss function (비용함수, 손실함수) : 현재 W, b값이 학습 데이터를 얼마나 잘 표현하는지 계량.
      머신러닝의 회귀모델들은 학습을 하며 손실함수의 반환값을 점점 줄여나가고 최소의 오류값을 찾아간다.
      
      //경사하강법(Gradient Descent) 손실값을 최소화하는 가장 일반적인 방법. 손실함수의 미분값이 최소가 되는 지점을 찾아야 한다. 
      learning weight개념. 초기값,  전역해,지역해 개념.
      초기값에 지정하는것도 여러 방법이 있고 아예 답을 못찾을 수 도있고,
      이후의 커스터마이징에 큰 영향을 미친다.
      

  - ##  **비지도학습**(unsupervised learning)
    - 군집분석
  - 강화학습    //결이 많이 다르다. 환경구성과 reward 설정이 키포인트


<예시>
> 스팸메일 판단 : 분류모델 : 메일제목, 발신인, 발신일시 등의 feature를 보고 스팸여부 예측.
   label이 이산적인 수
> 부동산가격 : 회귀모델 : 면적, 방갯수, 브랜드, 500m내 지하철수 등등으로 아파트가격 예측.
   label이 연속적인 수


- 비지도학습은 고차원을 저차원으로 축소하여 연산량을 줄여주는 PCA, SVD 기법을 사용
- 시각화 분석할때는 t-SNE

<데이터수집 및 경진대회 사이트>
해외 : 
    [**캐글**](www.kaggle.com)   //구글이 인수. 오 문제(Competitions)만 있는줄알았는데 데이터셋과 샘플 코드, 학습자료도 많네. 받을필요도 없고 거기서 바로 실행할 수 있고 GPU제공도 해준다.
    leaderboard에 제출하고 0.8이상이면 괜찮은 모델
    archive.ics.uci.edu/ml
    [데이터포털](dataportals.org)
    [위키피디아목록](en.wikipedia.org/wiki/List_of_datasets_for_machine-learning_research)
    [**괜찮은 머신러닝정리**](https://github.com/ml-tooling/best-of-ml-python)
    [최신 알고리즘과 역사](https://paperswithcode.com/)
    [케라스공홈](keras.io)

국내 : 
    [**데이콘**](dacon.io)
    [에이콘](aiconnect.kr/competition/list)
    아마추어가 아니라, 프로, 회사도 참여가능하면  상위몇명이 싹쓸이해나가는거 아닌가?
    [AI허브](aihub.or.kr)   //데이터와 모델의 퀄리티가 좀 낮은편
    [호야012](https://hoya012.github.io/)


<3교시>
데이터탐색(EDA)
- 라이브러리    //순서도 이순서가 좋다.
  - numpy : 고성능의 과학계산 컴퓨팅과 데이터분석에 필요한 기본 패키지
  - pandas : 고수준의 자료구조. 파이썬을 활용한 빠르고 쉬운 데이터분석 도구
  - matplotlib : numpy를 기반으로 그래프를 그리는 시각화 라이브러리
  - seaborn : matplotlib 기반 통계 시각화 도구(사용편의성, 디자인 등 장점)
  - sklearn : 머신러닝에 필요한 다양한 기능을 제공하는 패키지
  - tensorflow : 딥러닝 프레임워크


- [실습. 캐글의 주택가격예측](https://drive.google.com/drive/folders/1jfTHzFBUfgKywNpDnc3ZSF1vurnKC6-8)
//로컬환경과 관련없이 하려고 구글 드라이브와 colab사용할것임. 실행은 shift enter
1. .ipynb , .csv파일들 사본뜨고 이름에서 사본 지우기
2. 왼쪽사이드바에 폴더모양 아이콘 - 구글드라이브모양 아이콘 누르기
//구글 드라이브를 쓰는이유는 마찬가지로 어디에서나 접근할수 있고 컨테이너가 내려가도 데이터파일 살리기 위해서
3. 경고창 뜨면서 드라이브 마운트 코드가 들어가는데 실행시키기
4. 폴더 새로고침 버튼 누르면 마운트된 폴더 보인다.
5. 가지고올 .csv파일 우클릭해서 경로복사해서 pd.read_csv의 파라미터로 넣기
6. 가지고왔다면 항상 제일먼저 해야될건 데이터크기 파악. train.shape
7. 일부만 데이터 살펴보기. train.head()
8. 중복, 결측치, 이상치 확인
   //라이브러리들이 예외처리가 안되는게 많기 때문에 결측치가 있으면 분석 못한다. 판다스의 drop함수를 써서 제거하면되는데 먼저 왜 이 데이터는 결측치가 많을까? 생각해보기.
   
   <결측치 해소방법>
   - 행자체를 제거
   - 열 자체를 제거
   - 평균이나 중간값으로 채우기 : 평균이기때문에 해석하지 않는 효과
   - 세밀하게 유추해서 채워넣기  //결측치를 채워넣는 모델까지 추가로 만들면 베스트. 과적합이 되지 않는지 테스트
   - 결측의 유무를 나타내는 컬럼
   
   //주식 봉 비슷한 박스포맷 많이 사용함
   봉우리가 하나일때 적절함. 
   IQR. 수염빼고 가운데가 50%.
   기준선을 세우고 수염의 길이는 기준선내의 최대값, 최소값.
   기준선 벗어나면 아웃라이어로 표시
   (**중요**)모든걸 하나의 모델로 할 필요없다.
   고가주택은 이 모델에서는 빼고 다른 모델 구현 등
9.  데이터타입이 숫자형 범주형 구분.   .dtypes[col] != 'object'
10. 숫자형 변수의 데이터 확인. 특히 평균, 최소, 최대값    .describe() 
11. seaborn으로 간단한 산점도로 데이터 시각화
    1.  //x축에 따라 y축이 수렴하거나 발산하는 즉, 분산이 다른 선형은 단순선형분석하면 예측률이 떨어진다.
12. 모든 컬럼들에 대해서 상관도 분석
for col in numerics:
    plt.figure(figsize=(10, 4))
    sns.scatterplot(x=col, y='SalePrice', data=train)
    plt.show()
13. 히스토그램 (분포도)   수치를 범주화해서 유의미한 요소 찾기
for col in numerics:
    plt.figure(figsize=(10, 4))
    sns.histplot(x=col, hue='Price_cat', multiple='stack', data=train)
    plt.show()
14. displot, replot, catplot, histplot, kdeplot 등 seaborn의 여러 함수들이 있다.
15. 시각적 정보를 풍성화 하려면 같은 데이터의 같은 분석을 여러함수로 다양하게 표현해서 겹치는 방법이 있다.
16. 범주형 데이터는 판다스의 갯수세는 함수 활용
for col in categoricals:
    print(train[col].value_counts(), '\n')



<[자격증](https://www.dataq.or.kr/www/main.do)>
빅데이터분석기사        //국가공인 이 자격증이 생겨서 ADP위상 약해짐
ADP(데이터분석 전문가) / ADsP(데이터분석 준전문가)
DAP(데이터아키텍처 전문가) / DAsP(데이터아키텍처 준전문가)
SQLP(SQL전문가) / SQLD(SQL개발자)


Q. 문제정의를 잘못해서 모델을 잘못만들었지만 좋은모델이라고 생각할수 있는데 어떻게 막을수있나?
-> 해당모델의 다양한 평가지표 활용
예를들어 [분류성능평가지표](https://sumniya.tistory.com/26)
분류라면 정확도(Accuracy), 정밀도(Precision), 재현율(Recall)
재현율(Recall)은 '실제' true인것중 모델이 true라고 예측한것의 비율
정밀도(Precision)는 '모델'이 true라고 분류한것중 실제 true인것의 비율
이 둘은 trade off성격이 있다. 분석주제에 따라서 무엇을 더 중요하게 할지 결정하면된다.
Accuracy(정확도)는 가장 직관적으로 모델의 성능을 나타내는 지표.
    TP+TN  /  TP+FN+FP+TN

True Positive(TP) : 실제 True인 정답을 True라고 예측 (정답)
False Positive(FP) : 실제 False인 정답을 True라고 예측 (오답)
False Negative(FN) : 실제 True인 정답을 False라고 예측 (오답)
True Negative(TN) : 실제 False인 정답을 False라고 예측 (정답)

Q. 국비학원은 취업을 위해 거의 필수적으로 자바기반의 웹프로젝트를 최종으로 하고있는데, 그런 환경에서 머신러닝 모델을 쓰기위해서 추천하는 방법이 있으신지?
예를들어 파이스크립트, 자이썬, 자바의프로세스, DB를 통한 연동 등
=> 텐서플로우를 Node.js로 호출하는 방법.
또  
[Teachable Machine](https://teachablemachine.withgoogle.com/) 모델을 학습시키고 모델내보내기.
자바스크립트용 코드가 제공된다.


듣다가 생각난 좋은 아이디어
- 메뉴판 번역 : 영어든 한자든, 한글이든 OCR로 읽고 어떤 음식(사진, 맛평가, 유래 등)인지 보여주는 서비스
